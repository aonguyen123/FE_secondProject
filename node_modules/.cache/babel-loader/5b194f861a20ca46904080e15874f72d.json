{"ast":null,"code":"import { LOGIN, GET_INFO, GET_ERRORS, LOGIN_ERRORS, CLEAN_ERRORS_LOGIN } from '../constants/types';\nimport { setAuthToken, setToken, removeToken } from './../config';\nimport { callAPI, getAccessToken } from '../common';\n\nconst login = (email, password, history) => dispatch => {\n  callAPI('/auth/login', 'POST', {\n    email,\n    password\n  }).then(res => {\n    dispatch({\n      type: LOGIN,\n      payload: res.data\n    });\n    dispatch({\n      type: CLEAN_ERRORS_LOGIN,\n      payload: {}\n    });\n    setAuthToken(res.data.accessToken);\n    setToken(res.data);\n    history.push('/');\n  }).catch(err => {\n    dispatch({\n      type: LOGIN_ERRORS,\n      payload: err.response.data\n    });\n  });\n};\n\nconst getInfo = history => async dispatch => {\n  const result = await getAccessToken(history);\n\n  if (result) {\n    callAPI('/user/greet-me-protected?name=aonguyen').then(res => {\n      dispatch({\n        type: GET_INFO,\n        payload: res.data\n      });\n    }).catch(err => {\n      removeToken();\n      history.push('/not-authenticated');\n      dispatch({\n        type: GET_ERRORS,\n        payload: err.response.data\n      });\n    });\n  }\n};\n\nexport default {\n  login,\n  getInfo\n};","map":{"version":3,"sources":["E:/react-antd/frontend/src/actions/authenticated.action.js"],"names":["LOGIN","GET_INFO","GET_ERRORS","LOGIN_ERRORS","CLEAN_ERRORS_LOGIN","setAuthToken","setToken","removeToken","callAPI","getAccessToken","login","email","password","history","dispatch","then","res","type","payload","data","accessToken","push","catch","err","response","getInfo","result"],"mappings":"AAAA,SAASA,KAAT,EAAgBC,QAAhB,EAA0BC,UAA1B,EAAsCC,YAAtC,EAAoDC,kBAApD,QAA8E,oBAA9E;AACA,SAASC,YAAT,EAAuBC,QAAvB,EAAiCC,WAAjC,QAAoD,aAApD;AACA,SAASC,OAAT,EAAkBC,cAAlB,QAAwC,WAAxC;;AAEA,MAAMC,KAAK,GAAG,CAACC,KAAD,EAAQC,QAAR,EAAkBC,OAAlB,KAA8BC,QAAQ,IAAI;AACpDN,EAAAA,OAAO,CAAC,aAAD,EAAgB,MAAhB,EAAwB;AAAEG,IAAAA,KAAF;AAASC,IAAAA;AAAT,GAAxB,CAAP,CACKG,IADL,CACUC,GAAG,IAAI;AACTF,IAAAA,QAAQ,CAAC;AACLG,MAAAA,IAAI,EAAEjB,KADD;AAELkB,MAAAA,OAAO,EAAEF,GAAG,CAACG;AAFR,KAAD,CAAR;AAIAL,IAAAA,QAAQ,CAAC;AACLG,MAAAA,IAAI,EAAEb,kBADD;AAELc,MAAAA,OAAO,EAAE;AAFJ,KAAD,CAAR;AAIAb,IAAAA,YAAY,CAACW,GAAG,CAACG,IAAJ,CAASC,WAAV,CAAZ;AACAd,IAAAA,QAAQ,CAACU,GAAG,CAACG,IAAL,CAAR;AACAN,IAAAA,OAAO,CAACQ,IAAR,CAAa,GAAb;AACH,GAbL,EAcKC,KAdL,CAcWC,GAAG,IAAI;AACVT,IAAAA,QAAQ,CAAC;AACLG,MAAAA,IAAI,EAAEd,YADD;AAELe,MAAAA,OAAO,EAAEK,GAAG,CAACC,QAAJ,CAAaL;AAFjB,KAAD,CAAR;AAIH,GAnBL;AAoBH,CArBD;;AAuBA,MAAMM,OAAO,GAAGZ,OAAO,IAAI,MAAMC,QAAN,IAAkB;AACzC,QAAMY,MAAM,GAAG,MAAMjB,cAAc,CAACI,OAAD,CAAnC;;AACA,MAAIa,MAAJ,EAAY;AACRlB,IAAAA,OAAO,CAAC,wCAAD,CAAP,CACKO,IADL,CACUC,GAAG,IAAI;AACTF,MAAAA,QAAQ,CAAC;AACLG,QAAAA,IAAI,EAAEhB,QADD;AAELiB,QAAAA,OAAO,EAAEF,GAAG,CAACG;AAFR,OAAD,CAAR;AAIH,KANL,EAOKG,KAPL,CAOWC,GAAG,IAAI;AACVhB,MAAAA,WAAW;AACXM,MAAAA,OAAO,CAACQ,IAAR,CAAa,oBAAb;AACAP,MAAAA,QAAQ,CAAE;AACNG,QAAAA,IAAI,EAAEf,UADA;AAENgB,QAAAA,OAAO,EAAEK,GAAG,CAACC,QAAJ,CAAaL;AAFhB,OAAF,CAAR;AAIH,KAdL;AAeH;AACJ,CAnBD;;AAoBA,eAAe;AACXT,EAAAA,KADW;AAEXe,EAAAA;AAFW,CAAf","sourcesContent":["import { LOGIN, GET_INFO, GET_ERRORS, LOGIN_ERRORS, CLEAN_ERRORS_LOGIN } from '../constants/types';\r\nimport { setAuthToken, setToken, removeToken } from './../config';\r\nimport { callAPI, getAccessToken } from '../common';\r\n\r\nconst login = (email, password, history) => dispatch => {\r\n    callAPI('/auth/login', 'POST', { email, password })\r\n        .then(res => {\r\n            dispatch({\r\n                type: LOGIN,\r\n                payload: res.data\r\n            });\r\n            dispatch({\r\n                type: CLEAN_ERRORS_LOGIN,\r\n                payload: {}\r\n            })\r\n            setAuthToken(res.data.accessToken);\r\n            setToken(res.data);\r\n            history.push('/');\r\n        })\r\n        .catch(err => {\r\n            dispatch({\r\n                type: LOGIN_ERRORS,\r\n                payload: err.response.data\r\n            });\r\n        });\r\n};\r\n\r\nconst getInfo = history => async dispatch => {\r\n    const result = await getAccessToken(history);\r\n    if (result) {\r\n        callAPI('/user/greet-me-protected?name=aonguyen')\r\n            .then(res => {\r\n                dispatch({\r\n                    type: GET_INFO,\r\n                    payload: res.data\r\n                })\r\n            })\r\n            .catch(err => {\r\n                removeToken();\r\n                history.push('/not-authenticated');\r\n                dispatch ({\r\n                    type: GET_ERRORS,\r\n                    payload: err.response.data\r\n                });\r\n            });\r\n    }\r\n};\r\nexport default {\r\n    login,\r\n    getInfo\r\n}"]},"metadata":{},"sourceType":"module"}