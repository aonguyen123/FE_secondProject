{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = undefined;\n\nvar _autoComplete = require('antd/lib/auto-complete');\n\nvar _autoComplete2 = _interopRequireDefault(_autoComplete);\n\nvar _input = require('antd/lib/input');\n\nvar _input2 = _interopRequireDefault(_input);\n\nvar _icon = require('antd/lib/icon');\n\nvar _icon2 = _interopRequireDefault(_icon);\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _dec, _dec2, _desc, _value, _class, _class2, _temp;\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _debounce = require('lodash-decorators/debounce');\n\nvar _debounce2 = _interopRequireDefault(_debounce);\n\nvar _bind = require('lodash-decorators/bind');\n\nvar _bind2 = _interopRequireDefault(_bind);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectWithoutProperties(obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nfunction _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {\n  var desc = {};\n  Object['ke' + 'ys'](descriptor).forEach(function (key) {\n    desc[key] = descriptor[key];\n  });\n  desc.enumerable = !!desc.enumerable;\n  desc.configurable = !!desc.configurable;\n\n  if ('value' in desc || desc.initializer) {\n    desc.writable = true;\n  }\n\n  desc = decorators.slice().reverse().reduce(function (desc, decorator) {\n    return decorator(target, property, desc) || desc;\n  }, desc);\n\n  if (context && desc.initializer !== void 0) {\n    desc.value = desc.initializer ? desc.initializer.call(context) : void 0;\n    desc.initializer = undefined;\n  }\n\n  if (desc.initializer === void 0) {\n    Object['define' + 'Property'](target, property, desc);\n    desc = null;\n  }\n\n  return desc;\n}\n\nvar styles = {\n  'headerSearch': 'antd-pro-header-search-headerSearch',\n  'input': 'antd-pro-header-search-input',\n  'show': 'antd-pro-header-search-show'\n};\nvar HeaderSearch = (_dec = (0, _bind2.default)(), _dec2 = (0, _debounce2.default)(500, {\n  leading: true,\n  trailing: false\n}), (_class = (_temp = _class2 = function (_PureComponent) {\n  _inherits(HeaderSearch, _PureComponent);\n\n  _createClass(HeaderSearch, null, [{\n    key: 'getDerivedStateFromProps',\n    value: function getDerivedStateFromProps(props) {\n      if ('open' in props) {\n        return {\n          searchMode: props.open\n        };\n      }\n\n      return null;\n    }\n  }]);\n\n  function HeaderSearch(props) {\n    _classCallCheck(this, HeaderSearch);\n\n    var _this = _possibleConstructorReturn(this, (HeaderSearch.__proto__ || Object.getPrototypeOf(HeaderSearch)).call(this, props));\n\n    _this.onKeyDown = function (e) {\n      if (e.key === 'Enter') {\n        var onPressEnter = _this.props.onPressEnter;\n        var value = _this.state.value;\n        _this.timeout = setTimeout(function () {\n          onPressEnter(value); // Fix duplicate onPressEnter\n        }, 0);\n      }\n    };\n\n    _this.onChange = function (value) {\n      var _this$props = _this.props,\n          onSearch = _this$props.onSearch,\n          onChange = _this$props.onChange;\n\n      _this.setState({\n        value: value\n      });\n\n      if (onSearch) {\n        onSearch(value);\n      }\n\n      if (onChange) {\n        onChange(value);\n      }\n    };\n\n    _this.enterSearchMode = function () {\n      var onVisibleChange = _this.props.onVisibleChange;\n      onVisibleChange(true);\n\n      _this.setState({\n        searchMode: true\n      }, function () {\n        var searchMode = _this.state.searchMode;\n\n        if (searchMode) {\n          _this.input.focus();\n        }\n      });\n    };\n\n    _this.leaveSearchMode = function () {\n      _this.setState({\n        searchMode: false,\n        value: ''\n      });\n    };\n\n    _this.state = {\n      searchMode: props.defaultOpen,\n      value: ''\n    };\n    return _this;\n  }\n\n  _createClass(HeaderSearch, [{\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      clearTimeout(this.timeout);\n    }\n  }, {\n    key: 'debouncePressEnter',\n    // NOTE: 不能小于500，如果长按某键，第一次触发auto repeat的间隔是500ms，小于500会导致触发2次\n    value: function debouncePressEnter() {\n      var onPressEnter = this.props.onPressEnter;\n      var value = this.state.value;\n      onPressEnter(value);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var _props = this.props,\n          className = _props.className,\n          placeholder = _props.placeholder,\n          open = _props.open,\n          restProps = _objectWithoutProperties(_props, ['className', 'placeholder', 'open']);\n\n      var _state = this.state,\n          searchMode = _state.searchMode,\n          value = _state.value;\n      delete restProps.defaultOpen; // for rc-select not affected\n\n      var inputClass = (0, _classnames2.default)(styles.input, _defineProperty({}, styles.show, searchMode));\n      return _react2.default.createElement('span', {\n        className: (0, _classnames2.default)(className, styles.headerSearch),\n        onClick: this.enterSearchMode,\n        onTransitionEnd: function onTransitionEnd(_ref) {\n          var propertyName = _ref.propertyName;\n\n          if (propertyName === 'width' && !searchMode) {\n            var onVisibleChange = _this2.props.onVisibleChange;\n            onVisibleChange(searchMode);\n          }\n        }\n      }, _react2.default.createElement(_icon2.default, {\n        type: 'search',\n        key: 'Icon'\n      }), _react2.default.createElement(_autoComplete2.default, _extends({\n        key: 'AutoComplete'\n      }, restProps, {\n        className: inputClass,\n        value: value,\n        onChange: this.onChange\n      }), _react2.default.createElement(_input2.default, {\n        ref: function ref(node) {\n          _this2.input = node;\n        },\n        'aria-label': placeholder,\n        placeholder: placeholder,\n        onKeyDown: this.onKeyDown,\n        onBlur: this.leaveSearchMode\n      })));\n    }\n  }]);\n\n  return HeaderSearch;\n}(_react.PureComponent), _class2.propTypes = {\n  className: _propTypes2.default.string,\n  placeholder: _propTypes2.default.string,\n  onSearch: _propTypes2.default.func,\n  onChange: _propTypes2.default.func,\n  onPressEnter: _propTypes2.default.func,\n  defaultActiveFirstOption: _propTypes2.default.bool,\n  dataSource: _propTypes2.default.array,\n  defaultOpen: _propTypes2.default.bool,\n  onVisibleChange: _propTypes2.default.func\n}, _class2.defaultProps = {\n  defaultActiveFirstOption: false,\n  onPressEnter: function onPressEnter() {},\n  onSearch: function onSearch() {},\n  onChange: function onChange() {},\n  className: '',\n  placeholder: '',\n  dataSource: [],\n  defaultOpen: false,\n  onVisibleChange: function onVisibleChange() {}\n}, _temp), _applyDecoratedDescriptor(_class.prototype, 'debouncePressEnter', [_dec, _dec2], Object.getOwnPropertyDescriptor(_class.prototype, 'debouncePressEnter'), _class.prototype), _class));\nexports.default = HeaderSearch;\nmodule.exports = exports.default;","map":null,"metadata":{},"sourceType":"script"}